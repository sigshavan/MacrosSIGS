<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Macros de Chamado - TI Geral e SIGS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #3f51b5; /* Azul Escuro/√çndigo (Design original) */
            --secondary-color: #007bff; /* Azul vibrante */
            --background-dark: #1f2025;
            --text-light: #ffffff;
            --text-dark: #333333;
            --card-bg: rgba(255, 255, 255, 0.95);
            --shadow-light: 0 8px 30px rgba(0, 0, 0, 0.3);
            --border-radius: 12px;
            --accent-green: #28a745;
        }

        /* 1. Estiliza√ß√£o Global e Fundo (Fundo Azul) */
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            color: var(--text-dark);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            
            /* üîµ FUNDO AZUL ESCURO */
            background-color: #1a237e; /* Azul Escuro */
            background-image: linear-gradient(135deg, #1a237e 0%, #3f51b5 100%);
            background-size: cover; 
            background-attachment: fixed;
            
            position: relative;
            cursor: default; 
        }

        .container {
            background: var(--card-bg);
            padding: 40px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-light);
            max-width: 950px;
            width: 95%;
            z-index: 1;
        }

        /* 2. Cabe√ßalho */
        header {
            text-align: center;
            margin-bottom: 30px;
            color: var(--primary-color);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        header h1 {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        header p.subtitle {
            color: #6c757d;
            font-weight: 400;
        }
        
        /* ESTILO PARA A LOGO */
        .logo-section {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        .header-logo {
            width: 50px;
            height: auto;
            margin-right: 15px;
            border-radius: 8px;
        }
        /* ------------------------------------------- */


        /* 3. Seletor de Categoria e Macro */
        .select-group {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }

        .select-container {
            flex: 1;
            text-align: left;
        }

        .select-container label {
            display: block;
            margin-bottom: 8px;
            font-size: 1em;
            font-weight: 600;
            color: var(--text-dark);
        }

        .custom-select {
            width: 100%;
            padding: 12px 15px;
            border-radius: 8px;
            border: 2px solid var(--primary-color);
            background-color: #f8f9fa;
            font-size: 1em;
            appearance: none;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: border-color 0.3s;
        }

        .custom-select:focus {
            border-color: var(--secondary-color);
            outline: none;
        }
        
        .custom-select:disabled {
            background-color: #e9ecef;
            cursor: not-allowed;
            border-color: #ced4da;
        }


        /* 4. Output */
        .macro-output { 
            display: none; 
            margin-top: 30px; 
            padding: 20px; 
            border: 1px solid #ddd; 
            border-radius: var(--border-radius); 
            background: #ffffff; 
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05); 
        }

        #macroText { 
            width: 100%; 
            min-height: 250px; 
            padding: 15px; 
            border: none; 
            border-radius: 6px; 
            background: #f4f7f6; 
            font-family: monospace; 
            font-size: 0.95em; 
            line-height: 1.4; 
            resize: vertical; 
            margin-bottom: 15px; 
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05); 
        }

        .copy-button { 
            display: block; 
            width: 100%; 
            padding: 12px 20px; 
            background-color: var(--secondary-color); 
            color: var(--text-light); 
            border: none; 
            border-radius: 8px; 
            font-size: 1.1em; 
            font-weight: 600; 
            cursor: pointer; 
            transition: background-color 0.3s ease, transform 0.2s; 
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.4); 
        }

        .copy-button:hover { 
            background-color: #0056b3; 
            transform: translateY(-2px); 
        }

        .copy-button:active { 
            transform: translateY(0); 
        }

        #feedbackMessage { 
            margin-top: 15px; 
            text-align: center; 
            font-weight: 600; 
            color: var(--accent-green); 
            opacity: 0; 
            transition: opacity 0.5s; 
        }
        
        /* üü¢ GIF no Canto Inferior Esquerdo */
        .fun-animation {
            position: fixed;
            bottom: 20px;
            left: 20px; 
            width: 80px; 
            height: 80px;
            /* üü¢ URL DO NOVO GIF */
            background-image: url('https://media.tenor.com/KifRMfLKMdgAAAAi/joe-typing-joe-surprised-typing.gif'); 
            background-size: contain;
            background-repeat: no-repeat;
            pointer-events: none; /* N√£o interfere na intera√ß√£o do mouse */
            z-index: 100;
        }

        /* 6. Responsividade */
        @media (max-width: 600px) {
            .select-group {
                flex-direction: column;
                gap: 15px;
            }
            .header-logo {
                width: 40px;
            }
            .fun-animation {
                 /* Esconde ou move o GIF em telas pequenas para n√£o atrapalhar */
                display: none; 
            }
        }

    </style>
</head>
<body>

    <div class="container">
        <header>
            <div class="logo-section">
                <img src="https://i.imgur.com/sffq801.png" alt="Logo Havan Labs" class="header-logo">
                <h1>Seletor de Macros de Chamado</h1>
            </div>
            <p class="subtitle">TI Geral e SIGS - Agilize seu atendimento</p>
        </header>

        <div class="select-group">
            <div class="select-container">
                <label for="categorySelect">Selecione a Categoria Principal</label>
                <select id="categorySelect" class="custom-select" onchange="updateMacroOptions()">
                    <option value="">-- Selecione a √Årea --</option>
                    <option value="SIGS">SIGS (Seguran√ßa)</option>
                    <option value="HELP_DESK">Help Desk (TI Geral)</option>
                </select>
            </div>
            
            <div class="select-container">
                <label for="macroSelect">Selecione o Assunto</label>
                <select id="macroSelect" class="custom-select" onchange="displayMacro()">
                    <option value="">-- Selecione uma Categoria Primeiro --</option>
                </select>
            </div>
        </div>

        <div class="macro-output" id="macroOutput">
            <textarea id="macroText" readonly></textarea>
            <button class="copy-button" onclick="copyMacro()">
                <i class="fas fa-copy"></i> Copiar Texto da Macro
            </button>
            <p id="feedbackMessage">Macro copiada com sucesso!</p>
        </div>

    </div>
    
    <div class="fun-animation"></div>

    <script>
        // Objeto contendo todas as macros (MANTIDO INALTERADO)
        const allMacros = {
            'SIGS_CAMERA_FALHA': {
                name: 'CFTV - C√¢mera - Falha',
                text: `Assunto: Havan Labs - Help Desk - SIGS-CFTV - C√¢mera - Falha\n\n[SIGS] C√¢mera. FL. \n\nNome da c√¢mera: [Campo de Texto]\nSetor:\n[ ] AREA DE VENDAS\n[ ] CAIXAS\n[ ] DEPOSITO\\DOCA\\PAR\n[ ] ENTRADA\\SAIDA\\RP\n[ ] EXTERNAS\n[ ] OUTRAS: [Campo de Texto]\n\nProblema:\n[ ] C√¢mera off-line. Informa√ß√µes relevantes: [Campo de Texto]\n[ ] Outros (Descrever): [Campo de Texto]`
            },
            'SIGS_ALARME_SENSOR_PANICO': {
                name: 'Alarme - Sensor/P√¢nico - Falha',
                text: `Assunto: Havan Labs - Help Desk - SIGS - Alarme de Intrus√£o - Sensor/P√¢nico - Falha\n\n[SIGS] Sensor. FL. \n\nQual √© a solicita√ß√£o?\n[ ] Nova Requisi√ß√£o\nMotivo da requisi√ß√£o:\n\n[ ] Manuten√ß√£o\n\nOnde √© o problema?\n[ ] Sensor\n[ ] Bot√£o p√¢nico\n\nQual o problema?\n[ ] N√£o constando no relat√≥rio de alarme ap√≥s o teste\n[ ] Disparos falsos ap√≥s ativa√ß√£o da loja. Data: //\n[ ] Danificado \n[ ] Outros. Especificar: [Campo de Texto]\n\nN√∫mero e nome das zonas: [Campo de Texto]\nBot√£o p√¢nico fixo: [ ]Apoio, [ ]Bir√¥, [ ]Par, [ ]Tesouraria. N√∫mero: [Campo de Texto]\nP√¢nico controle remoto. N√∫mero do controle: [Campo de Texto]`
            },
            'SIGS_ALARME_CENTRAL_FALHA': {
                name: 'Alarme - Central - Falha',
                text: `Assunto: Havan Labs - Help Desk - SIGS - Alarme de Intrus√£o - Central - Falha\n\n[SIGS] Central de Alarme. FL. \n\nModelo:\n[ ] Intelbras 4010 smart\n[ ] Bosch B6512G\n[ ] Bosch B9512G\n\nProblemas:\n[ ] Bateria\n[ ] Danificado\n[ ] Placa da central\n[ ] Sirene com problema\n[ ] Outros: [Campo de Texto]`
            },
            'SIGS_CONTROLE_ACESSO_FALHA': {
                name: 'Controle de Acesso - Leitor/Biometria',
                text: `Assunto: Havan Labs - Help Desk - SIGS - Controle de Acesso - Leitor - Falha\n\n[SIGS] Controle de Acesso. FL.\n\nDe qual setor:\n[ ] Alarme (Teclado de ativa√ß√£o)\n[ ] Refeit√≥rio\n[ ] Par\n\nQual o problema?\n[ ] Danificado\n[ ] N√£o realiza a leitura da biometria\n[ ] Outros (especificar): [Campo de Texto]\n\n*Anexar imagem`
            },
            'SIGS_ALARME_CENTRAL_INDIVIDUAL_FALHA': {
                name: 'Alarme - Central Individual - Falha',
                text: `Assunto: Havan Labs - Help Desk - SIGS - Alarme de Intrus√£o - Central Individual - Falha\n\n[SIGS] Central de Alarme Individual. FL. \nProblema na central individual:\n[ ] Bateria fraca\n[ ] Placa da central individual com problema\n[ ] Sirene com problema\n[ ] Controle da porta de emerg√™ncia. Qual √© a porta de emerg√™ncia? [Campo de Texto]\n[ ] Outros (especificar): [Campo de Texto]`
            },
            'SIGS_SECURITY_DESK_ERRO_RP_TELA': {
                name: 'Security Desk - Erro (RP/TELA)',
                text: `Assunto: Havan Labs - Help Desk - SIGS - Security Desk - Erro\n\n[SIGS] Verificar o programa Security Center. FL.\n\nPC: RP | IP: [Campo de Texto]\n[ ] N√£o est√° conectando.\n[ ] N√£o inicia automaticamente o Security Desk.\nLayout RP:\n[ ] C√¢meras com falhas nas imagens.\n[ ] Outros (Especificar): [Campo de Texto]\n\n--- PC: TELA ---\nPC: TELA | IP: [Campo de Texto]\n[ ] N√£o est√° conectando. \n[ ] N√£o inicia automaticamente o Security Desk.\nLayout tela:\n[ ] C√¢meras com falhas nas imagens.\n[ ] Outros (Especificar): [Campo de Texto]`
            },
            'SIGS_SECURITY_DESK_ERRO_TESOURARIA': {
                name: 'Security Desk - Erro (TESOURARIA)',
                text: `Assunto: Havan Labs - Help Desk - SIGS - Security Desk - Erro\n\n[SIGS] Verificar o programa Security Center. FL.\n\nPC: TESOURARIA | IP: [Campo de Texto]\nUsu√°rio: [ ]usuario [ ]havan\n[ ] Erro. Descri√ß√£o do problema: [Campo de Texto]\n[ ] Nova solicita√ß√£o (Descrever): [Campo de Texto]\n[ ] Outros (Especificar): [Campo de Texto]\n\n--- Altera√ß√£o de Senha ---\n\nAlterar senha do Security Desk na Tesouraria\nUsu√°rio: [ ]usuario [ ]havan\nMotivo: [Campo de Texto]`
            },
            'SIGS_SECURITY_DESK_LAYOUT': {
                name: 'Security Desk - Altera√ß√£o de Layout',
                text: `Assunto: Havan Labs - Help Desk - SIGS - Security Desk - Altera√ß√£o de Layout\n\n[SIGS] Verificar o programa Security Center. FL.\n\nLayout RP:\n[ ] Incluir a c√¢mera ( ) no RP1[], RP2[]\n[ ] Substituir a c√¢mera ( ) pela c√¢mera ( )\n\nLayout tela:\n[ ] C√¢mera ( ) n√£o consta no layout do: Tela01[] Tela02[]\n[ ] Substituir a c√¢mera ( ) pela c√¢mera ( )`
            },
            'SIGS_NUUO_ERRO': {
                name: 'Nuuo - Erro (RP/TESOURARIA)',
                text: `Assunto: Havan Labs - Help Desk - SIGS - Sistema Nuuo - Erro\n\n[SIGS] Nuuo F. \n\nPC: RP | IP: [Campo de Texto]\n[ ] N√£o inicia automaticamente o Nuuo.\n[ ] N√£o est√° ativado o autologon do usu√°rio CFTV do Windows.\nLayout Rp:\n[ ] C√¢mera ( ) n√£o consta no layout.\n[ ] Substituir a c√¢mera ( ) pela c√¢mera ( )\n[ ] C√¢meras com falhas nas imagens.\n[ ] Outros (Especificar): [Campo de Texto]\n\n--- PC: Tesouraria ---\nPC: Tesouraria | IP: [Campo de Texto]\n[ ] Erro. Descri√ß√£o do problema: [Campo de Texto]\n[ ] Nova requisi√ß√£o. Descrever: [Campo de Texto]\n[ ] Outros. Especificar: [Campo de Texto]\nUsu√°rio: [ ]usuario [ ]havan`
            },
            'SIGS_ALARME_SENHA': {
                name: 'Alarme - Senha (Ativa√ß√£o/Desativa√ß√£o)',
                text: `Assunto: Havan Labs - Help Desk - SIGS - Senha Alarme - [Incluir/Excluir]\n\n[SIGS] Senha Alarme. FL.\n\nQual a solicita√ß√£o?\n[ ] Incluir senha de ativa√ß√£o e desativa√ß√£o da loja.\n[ ] Excluir senha de ativa√ß√£o e desativa√ß√£o da loja.\n\nMotivo da Solicita√ß√£o:\nC√≥digo: [Campo de Texto]\nNome: [Campo de Texto]\nPerfil: [Campo de Texto]`
            },

            // ====================================================================================================
            // MACROS HELP DESK (TI Geral)
            // ====================================================================================================
            'HD_IMPRESSORA_CAIXA': {
                name: 'Impressora de Caixa (ECF/NFCe) - Falha',
                text: `Assunto: Havan Labs - Help Desk - IMPRESSORA - ECF/NFCe - Falha\n\n[IMPRESSORA] Verificar impressora de caixa [PDV ]. FL.\n\nMarca/Modelo:\n[ ] Elgin I9\n[ ] Epson TM-T900F\n[ ] Bematech - Modelo: [Campo de Texto]\n\nN√∫mero de S√©rie: [Campo de Texto]\n\nO que aconteceu?\n[ ] N√£o liga\n[ ] Travou durante a venda\n[ ] Encravamento de papel\n[ ] Impress√£o est√° saindo com falha/borrada\n[ ] ECF Bloqueada - Motivo do bloqueio: [Campo de Texto]\n[ ] ECF com data/hora divergente\n[ ] N√£o √© reconhecido pelo computador\n[ ] Outros, explique: [Campo de Texto]`
            },
            'HD_IMPRESSORA_SETOR': {
                name: 'Impressora Setor (Ricoh/Samsung/HP) - Falha',
                text: `Assunto: Havan Labs - Help Desk - IMPRESSORA - Setor - Falha\n\nVerificar impressora [Setor]. FL.\n\nMarca: Ricoh [ ] Sansung [ ] HP [ ]\nModelo: [Campo de Texto]\nN¬∫ DE S√âRIE DO EQUIPAMENTO: [Campo de Texto] (INFORMA√á√ÉO OBRIGAT√ìRIA)\n\nProblemas:\n[ ] Atolamento de papel, em qual parte? [Campo de Texto]\n[ ] Tampa quebrada, qual delas? [Campo de Texto]\n[ ] Apresentando o seguinte erro: [Campo de Texto] (Ex: SC542)\n[ ] Apresentando ru√≠dos quando envia uma impress√£o, foi trocado o toner?`
            },
            'HD_IMPRESSORA_ZEBRA': {
                name: 'Impressora Zebra (Dep√≥sito) - Falha',
                text: `Assunto: Havan Labs - Help Desk - IMPRESSORA - Zebra Dep√≥sito - Falha\n\n[SOFTWARE] Verificar impressora [Zebra Dep√≥sito]. FL. \n\nColaborador(a) entrou em contato informando o seguinte problema:\n[ ] Impressora n√£o est√° calibrando - *ANEXAR FOTO DO LASER*\n[ ] Impress√£o saindo fraca/borrada - *ANEXAR FOTO DOS CILINDROS E DA CABE√áA DE IMPRESS√ÉO*\n[ ] Impressora sem rede - MAC: [Campo de Texto] (anexar foto)\n[ ] Impressora nova precisa de reserva - MAC: [Campo de Texto] (anexar foto)\n[ ] Fonte de cabe√ßa para baixo/desconfigurada - *ANEXAR FOTO*\n[ ] Outros(Explique): [Campo de Texto] \n\nAnexar obrigatoriamente foto da etiqueta que est√° sendo usada. Inserir anexo do problema.`
            },
            'HD_TROCA_ANTECIPADA_TONER': {
                name: 'Impressora - Troca Antecipada de Toner (Aviso)',
                text: `Assunto: Havan Labs - Help Desk - IMPRESSORA - Troca Antecipada de Toner\n\nVERIFICAR TROCA ANTECIDAPADA []. FL.\n\nIdentificamos uma troca incorreta do cartucho de toner em sua impressora.\n\nEnt√£o, para garantir o abastecimento proativo no m√™s subsequente, orientamos que retorne esse cartucho para o seu equipamento utilize at√© o seu t√©rmino.\n\nCom esta a√ß√£o voc√™ evita desperd√≠cio, custos de excedente de toner e colabora com o meio ambiente.`
            },
            'HD_CAIXA_PINPAD': {
                name: 'CAIXA - Pinpad (PPC-930) - Falha',
                text: `Assunto: Havan Labs - Help Desk - CAIXA - Pinpad - Falha\n\nVerificar pinpad do PDV [PDV]. FL.\n\nMarca: REDE | Modelo: PPC-930 | N√∫mero de s√©rie: [Campo de Texto]\n\nDescri√ß√£o: O que aconteceu?\n[ ] N√£o liga\n[ ] N√£o l√™ cart√£o tarja\n[ ] Travou durante a venda\n[ ] N√£o l√™ cart√£o com chip\n[ ] N√£o l√™ cart√£o (nenhum tipo)\n[ ] N√£o √© reconhecido pelo computador\n[ ] Outro, explique: [Campo de Texto]`
            },
            'HD_CAIXA_LEITOR': {
                name: 'CAIXA - Leitor de C√≥digo de Barras - Falha',
                text: `Assunto: Havan Labs - Help Desk - CAIXA - Leitor - Falha\n\nVerificar Leitor do PDV [PDV]. FL.\n\nProblema:\n[ ] O leitor d√° retorno sonoro, mas n√£o est√° lendo os c√≥digo de barras\n[ ] O leitor sem retorno sonoro e sem ler os c√≥digo de barras\n[ ] O leitor n√£o est√° ligando\n[ ] Outro, descreva: [Campo de Texto]\n\nMarca: [Campo de Texto] | Modelo: [Campo de Texto] | S/N: [Campo de Texto] | Garantia: [Campo de Texto] | Adaptador: [ ]sim [ ] n√£o`
            },
            'HD_CAIXA_NFCESAT_INTEGRACAO': {
                name: 'CAIXA - Erro de Integra√ß√£o NFC-e / SAT',
                text: `Assunto: Havan Labs - Help Desk - CAIXA - Integra√ß√£o NFC-e/SAT - Falha\n\nVerificar erro de Integra√ß√£o NFC-e / SAT. FL.\n\nLoja entrou em contato, informando que ao iniciar o sistema do PDV reporta a mensagem de erro:\n"Aten√ß√£o! Integra√ß√£o NFCe/SAT indisponivel! Contate o suporte atrav√©s do ramal 25105025"`
            },
            'HD_CAIXA_SAT_FALHA': {
                name: 'CAIXA - SAT - Falha',
                text: `Assunto: Havan Labs - Help Desk - CAIXA - SAT - Falha\n\nSAT apresentou erro no PDV [PDV]. FL. \n\nMarca/Modelo:\n[ ] Elgin Linker II\n[ ] Elgin Smart SAT\n\nN√∫mero de S√©rie: [Campo de Texto] | MAC: [Campo de Texto]\n\nDescri√ß√£o: O que aconteceu?\n[ ] N√£o liga\n[ ] Sem rede\n[ ] Bloqueado\n[ ] Hor√°rio divergindo mais de uma hora\n[ ] N√£o √© reconhecido pelo computador\n[ ] Erro ao realizar consulta do SAT. Descreva: [Campo de Texto]\n[ ] Outro, explique: [Campo de Texto]`
            },
            'HD_CAIXA_POS': {
                name: 'CAIXA - Maquineta de POS (REDE)',
                text: `Assunto: Havan Labs - Help Desk - CAIXA - Maquineta POS - Falha\n\nVerificar maquineta de POS. FL. \n\nMarca: REDE | N/S(Rede): [Campo de Texto] | Operadora: [Campo de Texto]\n\nDescrever o problema: [Campo de Texto]`
            },
            'HD_EMAIL_PROBLEMA': {
                name: 'E-mail - Problemas (Acesso, Recebimento, Teams, Auth)',
                text: `Assunto: Havan Labs - Help Desk - E-mail - Problema\n\nVerificar problema de E-mail. FL.\n\nFoi verificado o seguinte problema abaixo:\n[ ] N√£o realiza acesso a caixa de e-mail. Qual modo de entrada? Aplicativo ou WEB? (Anexar Print)\n[ ] N√£o est√° recebendo e-mail de algum remetente? Qual? (Informar) (Anexar Print) (Informar Data)\n[ ] Erro de autentifica√ß√£o no Microsoft Autenticador (Anexar Print) (Informar E-mail)\n[ ] Erro na aplica√ß√£o Microsoft Teams (Anexar Print)\n[ ] N√£o possui assinatura de e-mail (e-mail espelho)\n[ ] Conceder acesso a caixa de e-mail compartilhada. Tipo de permiss√£o? [Campo de Texto] E-mail a ser liberado? [Campo de Texto]`
            },
            'HD_EMAIL_NOVO_COLABORADOR': {
                name: 'E-mail - Cria√ß√£o de Usu√°rio/Libera√ß√£o',
                text: `Assunto: Havan Labs - Help Desk - E-mail - Novo Colaborador/Libera√ß√£o\n\nVerificar solicita√ß√£o de usu√°rio de acesso para o novo colaborador [Colaborador]. FL.\n\nGerente entrou em contato solicitando cria√ß√£o de usu√°rio e senha de acesso para o novo colaborador.\n\nUsu√°rio: [Campo de Texto] (print do simula√ß√£o de envio de e-mail)\nUsu√°rio Espelho: [Campo de Texto]\n\nLibera√ß√µes:\n[ ] E-mail - Outlook 365\n[ ] Teams Microsoft`
            },
            'HD_EMAIL_SITEF_WEB': {
                name: 'E-mail - Cria√ß√£o para SITEF WEB',
                text: `Assunto: Havan Labs - Help Desk - E-mail - Cria√ß√£o para SITEF WEB\n\nCria√ß√£o de e-mail para uso no SITEF WEB. FL.\n\nNecess√°rio cria√ß√£o de e-mail para uso na plataforma SITEF WEB e redirecionamento dos e-mails recebidos para a caixa: sitefloja@havan.com.br \n\nFilial ** - [Campo de Texto]\nColaborador: ***** [Campo de Texto]\nE-mail: sitef***@havan.com.br [Campo de Texto]\n\nNecess√°rio que o redirecionamento seja feito para: sitefloja@havan.com.br`
            },
            'HD_PC_ADM_FALHA': {
                name: 'Computador ADM/Setor - Falha',
                text: `Assunto: Havan Labs - Help Desk - Computador ADM - Falha\n\nVerificar Computador do ADM [Setor]\n\nQual o problema? Descrever: [Campo de Texto]\n\nMarca: [Campo de Texto]\nModelo: [Campo de Texto]\nHostname/IP: [Campo de Texto]\nDisco de Armazenamento: HDD [ ] SSD [ ] Tamanho [GB]\nC√≥d/Nome usu√°rio: [Campo de Texto]\nIdentifica√ß√£o da mesa: [Campo de Texto]\n\nConex√£o do Monitor \n( ) VGA com adaptador VGA/HDMI\n( ) VGA sem adaptador\n( ) Display Port\n( ) HDMI`
            },
            'HD_MONITOR_FALHA': {
                name: 'Monitor - Falha',
                text: `Assunto: Havan Labs - Help Desk - HARDWARE - Monitor - Falha\n\nVerificar Monitor [TERMINAL] - Fl.\n\nQual o problema? Descrever: [Campo de Texto]\n\nMarca: [Campo de Texto] | Modelo: [Campo de Texto]\n\nMonitor - ( ) VGA ( ) Display Port ( ) HDMI\nPossui adaptador? ( )Sim ( ) N√£o`
            },
            'HD_WEBCAM_FALHA': {
                name: 'Webcam/C√¢mera de Biometria - Falha',
                text: `Assunto: Havan Labs - Help Desk - HARDWARE - Webcam - Falha\n\nVerificar Webcam [TERMINAL] - Fl.\n\nProblema:\n[ ] Est√° sem a lente\n[ ] N√£o passa imagem\n[ ] Est√° quebrada (anexar imagem)\n[ ] N√£o √© reconhecida pelo computador\n[ ] Outro, descreva: [Campo de Texto]\n\nMarca/Modelo:\n[ ] C√¢mera de Biometria Facial Acesso (Credi√°rio)\n[ ] Lifecam HD 3000 (EducaHavan) \n[ ] HD Pro Webcam C920 (EducaHavan)\nInformar N/S: [Campo de Texto]`
            },
            'HD_REDE_FALHA': {
                name: 'Rede/Conex√£o - Falha',
                text: `Assunto: Havan Labs - Help Desk - REDE - Terminal sem Conex√£o\n\nO terminal do [Terminal] n√£o est√° conectado na rede. FL.\n\nIP/Host: [Campo de Texto]\nMAC: [Campo de Texto]\nTipo de conex√£o: [ ]Ethernet [ ]Wireless [ ]Bridge`
            },
            'HD_REMOTA_TRAVAMENTO': {
                name: '√Årea Remota - Travamento',
                text: `Assunto: Havan Labs - Help Desk - √Årea Remota - Travamento\n\nVerificar travamento na √°rea remota. FL.\n\nEspecifique o problema: [Campo de Texto]\n\nFoi verificado que o servidor Vwts (informar aqui o N¬∫) est√° apresentando v√°rios travamentos ao decorrer do dia.\nIP do terminal: [Campo de Texto]\nNLB: [Campo de Texto]`
            },
            'HD_ACESSOS_SISTEMA_GERENCIAL': {
                name: 'Acessos - Sistema Remoto Gerencial',
                text: `Assunto: Havan Labs - Help Desk - ACESSOS - Sistema Remoto Gerencial\n\nLibera√ß√£o de acesso ao sistema remoto Gerencial FL\n\nO gerente da filial ir√° entrar em per√≠odo de f√©rias, portanto ser√° necess√°rio fornecer permissionamento para o colaborador abaixo.\nColaborador Solicitante: [Campo de Texto] \nNLB: (172.16.0.71)`
            },
            'HD_ACESSOS_BLOQUEIO_SITE': {
                name: 'Acessos - Bloqueio/Libera√ß√£o de Site',
                text: `Assunto: Havan Labs - Help Desk - ACESSOS - Bloqueio/Libera√ß√£o de Site\n\nVerificar Bloqueio de acesso ao site. FL. \n\nLibera√ß√£o de Acesso a Internet.\nUsu√°rio: [Campo de Texto]\nIP do PC: [Campo de Texto] \nFilial: [Campo de Texto]\nURL: [Campo de Texto]\nMotivo: [Campo de Texto]\n\n*Anexar print do bloqueio.`
            },
            'HD_RF_SOFTWARE_FALHA': {
                name: 'RF (Software) - Falha',
                text: `Assunto: Havan Labs - Help Desk - RF - Software - Falha\n\nSOFTWARE: Verificar RF [SETOR]. FL. \n\nMarca: [Honeywell - Datalogic]\nSetor:\n[ ] Dep√≥sito .57\n[ ] Visual .58\n[ ] Lista .59\n\nProblema:\n[ ] RF est√° sem rede - MAC: [Campo de Texto]\n[ ] RF n√£o acessa conex√£o remota - NLB: [Campo de Texto]\n[ ] RF n√£o est√° lendo produtos\n[ ] RF pinga mas n√£o acessa (Anexar print do ping)\n[ ] RF est√° com IP fora do padr√£o - MAC: [Campo de Texto]\n[ ] Outro, explique: [Campo de Texto]`
            },
            'HD_RF_HARDWARE_FALHA': {
                name: 'RF (Hardware) - Carregador/Dano',
                text: `Assunto: Havan Labs - Help Desk - RF - Hardware - Carregador\n\nHARDWARE: Verificar carregador de RF [SETOR] - Fl.\n\nMarca: [Honeywell - Datalogic]\n\nProblema:\n[ ] Carregador com fios expostos\n[ ] N√£o carrega\n[ ] Pino do carregador quebrado\n[ ] Outros\n\n*Necess√°rio ter foto do equipamento mesmo n√£o sendo falha aparente.`
            },
            'HD_MOBICONTROL_SOFTWARE': {
                name: 'Mobicontrol (Software) - Falha',
                text: `Assunto: Havan Labs - Help Desk - MOBICONTROL - Software - Falha\n\nSOFTWARE: Verificar celular [NOME NO MOBICONTROL]. FL.\n\nSetor:\n[ ] Pacote - ()01 ()02 ()03 () Todos\n[ ] Cadastro ()01 ()02 () Todos\n[ ] RFID\n[ ] Vendas - Vendedor: [Campo de Texto] - () Todos\n[ ] Havan.com - ()01 ()02 ()03\n\nProblema:\n[ ] Sem Rede\n[ ] Celular estava travado\n[ ] Lentid√£o no aplicativo: [NOME DO APP]\n[ ] Celular foi resetado ao modo de f√°brica\n[ ] Aplicativo [NOME DO APP] est√° como Pacote n√£o encontrado/n√£o abre\n[ ] Outro, descreva: [Campo de Texto] \n\nIP: [Campo de Texto] | IMEI: [Campo de Texto] | MAC: [Campo de Texto]`
            },
            'HD_MOBICONTROL_HARDWARE': {
                name: 'Mobicontrol (Hardware) - Falha',
                text: `Assunto: Havan Labs - Help Desk - MOBICONTROL - Hardware - Falha\n\nHARDWARE: Verificar celular [NOME NO MOBICONTROL]. FL.\n\nSetor:\n[ ] Pacote - () 01 () 02 () 03 - [] Todos\n[ ] Cadastro - () 01 () 02 - [] Todos\n[ ] Vendas - Vendedor: [Campo de Texto] - [] Todos\n[ ] RFID\n\nProblema: \n[ ] N√£o liga\n[ ] Celular estava travado\n[ ] Touchscreen n√£o funciona\n[ ] Tela est√° com avaria; (anexar imagem)\n[ ] Outro, descreva: [Campo de Texto]\n\nIP: [Campo de Texto] | IMEI: [Campo de Texto] | MAC: [Campo de Texto]`
            },
            'HD_INFINITE_VENDA': {
                name: 'Infinite - Erro ao Realizar Venda',
                text: `Assunto: Havan Labs - Help Desk - INFINITE - Erro ao Vender\n\nVerificar erro ao realizar venda no Infinite. FL.\n\nColaborador (a) entrou em contato informando que est√° com problemas para realizar a venda via Infinite.\n\nMensagem de erro: [Campo de Texto]\nCliente: [Campo de Texto] | Produto: [Campo de Texto]\nModalidade de venda: () Despacho loja () Retira f√°cil () Venda Futura () Venda Normal ()Venda Ordem\nForma de pagamento: [Campo de Texto]\nCep: [Campo de Texto] Endere√ßo: [Campo de Texto]\nIP do mobile: [Campo de Texto]\n\n**Necess√°rio anexar v√≠deo do procedimento.`
            },
            'HD_NOTAS_FISCAIS': {
                name: 'Notas Fiscais - Erro de Emiss√£o/Transmiss√£o',
                text: `Assunto: Havan Labs - Help Desk - NOTAS FISCAIS - Erro de Emiss√£o\n\nERRO AO EMITIR NOTA FISCAL. FL.\n\nO colaborador (a), entrou em contato informando que n√£o estava sendo poss√≠vel realizar a emiss√£o ou transmiss√£o de nota fiscal.\n\nSelecione o que melhor corresponder a solicita√ß√£o:\n() - Consumo Indevido. [Consulte NT 2018.002 v1.00]\n() - Processamento pendente\n() - N√£o respondendo\n() - Tempo limite excedido\n() - Sefaz estado [] Indispon√≠vel\n() - IE n√£o foi informado\n() - Falha no Schema XML\n() - Rejei√ß√£o, Qual? Especifique: [Campo de Texto]\n\nCliente: Nome | Opera√ß√£o: () - Sa√≠da ou () - Entrada | Valor: ####\nData opera√ß√£o: ##/##/#### | Documento ( N¬∫ Nota ): ########## | NOP: ######\nSitua√ß√£o nota: () - Cancelada ou () - Autorizada\n\n** Anexar imagem do erro**`
            },
            'HD_RADIO_FALHA': {
                name: 'R√°dio/Microfone - Falha',
                text: `Assunto: Havan Labs - Help Desk - R√ÅDIO - Falha\n\nR√ÅDIO. FL. \nO que aconteceu?\n[ ] Anuncio de placas n√£o est√° funcionando\n[ ] R√°dio interna n√£o toca em determinado setor - Setor: [Campo de Texto]\n[ ] Programa√ß√£o: [ ]Parou, [ ]N√£o Iniciou, [ ]N√£o Terminou\n[ ] Volume do(a) [ ]R√°dio, [ ]An√∫ncio de placas, [ ]Microfone, estava: [ ]Alto; [ ]Baixo; [ ]Mudo\n[ ] Outro, explique: [Campo de Texto]\n\n--- Microfone do Cadastro ---\n\nVerificar microfone do cadastro. FL.  \nQual o problema?\n[ ] Microfone n√£o liga\n[ ] Apresenta ru√≠do durante o uso\n[ ] Apresenta dano f√≠sico (anexar imagem)\n[ ] Microfone n√£o interrompe a r√°dio ao usar e o som do microfone: [ ]√â aud√≠vel; [ ]N√£o sai\n[ ] Outro, Explique: [Campo de Texto]`
            },
            'HD_TELEFONIA_RAMAL': {
                name: 'Telefonia/Ramal - Falha',
                text: `Assunto: Havan Labs - Help Desk - TELEFONIA - Falha\n\nVERIFICAR TELEFONIA. FL. \n\nProblema de: [ ] LIGA√á√ÉO INTERNA [ ] LIGA√á√ÉO EXTERNA\nAo: [ ] RECEBER [ ] FAZER\nCom algum ramal espec√≠fico?\n[ ] N√£o, s√£o todos\n[ ] Sim, √© com apenas o: [Campo de Texto]\nDetalhes: [Campo de Texto]\n\n--- Ramal F√≠sico ---\n\nVerificar telefone [Setor - n√∫mero] - Fl.\n[ ] Ramal n√£o liga\n[ ] Patch-Cords invertidos\n[ ] LEDS piscando/Ramal mudo\n[ ] Cabo espiral com fios expostos/mal contato\n[ ] Outros, descreva: [Campo de Texto]\nMarca: [ ] Yealink; [ ] Intelbras; [ ] Khomp; Modelo: [Campo de Texto]`
            },
            'HD_RELOGIO_PONTO': {
                name: 'Rel√≥gio Ponto - Falha',
                text: `Assunto: Havan Labs - Help Desk - REL√ìGIO - Falha\n\nVerificar Rel√≥gio Ponto - Fl.\n\nMarca/Modelo:\n[ ] Dimep-printpoint II (preto-modelo velho)\n[ ] Dimep-printpoint III (cinza modelo novo)\n[ ] Dimep Smart Print (preto, parte de baixo arredondada)\n\nN√∫mero de s√©rie: [Campo de Texto] \n\nProblema:\n[ ] N√£o liga\n[ ] Registros n√£o est√£o sendo importados\n[ ] Equipamento bloqueado (Rap Manuten√ß√£o)\n[ ] N√£o corta papel/Atolamento de papel\n[ ] Impress√£o apagada\n[ ] Dano f√≠sico.\n[ ] Outro, descreva: [Campo de Texto]\n\n*Anexar m√≠dia do problema.`
            },
            'HD_TV_INTERNA': {
                name: 'TV Interna - Falha',
                text: `Assunto: Havan Labs - Help Desk - TV - Falha\n\nVerificar problema na TV interna [Setor] - Fl.\n\nTipo de conex√£o do painel:\n[ ] HDMI\n[ ] Coaxial\n\nO que aconteceu:\n[ ] Programa√ß√£o n√£o iniciou\n[ ] Programa√ß√£o travada (anexar V√≠deo)\n[ ] TVs sem sinal (Especificar os testes)\n[ ] Outro, explique: [Campo de Texto]`
            },
            'HD_RELATORIO_FALHA': {
                name: 'Relat√≥rio - Falha ao Gerar',
                text: `Assunto: Havan Labs - Help Desk - RELAT√ìRIO - Falha ao Gerar\n\nVerificar falha ao gerar relat√≥rio [Setor] - Fl.\n\nColaborador(a) entrou em contato informando que o relat√≥rio [RELAT√ìRIO] est√° apresentando uma falha ao ser gerado.\n\nProblema:\n[ ] Gera o relat√≥rio em branco;\n[ ] Apresenta uma mensagem de erro; (print em anexo.)\n[ ] Encontra-se desatualizado;\n[ ] Busca informa√ß√µes incoerentes com o filtro;\n[ ] Outros; (explique): [Campo de Texto]\n\nCaminho: [Campo de Texto] | Filtros: [Campo de Texto] | Data: [Campo de Texto]`
            },
            'HD_APPHAVAN_ERRO': {
                name: 'SuperApp Havan - Erro',
                text: `Assunto: Havan Labs - Help Desk - APP HAVAN - Erro\n\nVerificar erro no SuperApp Havan. FL \n\nPara melhor an√°lise, preencha as informa√ß√µes abaixo:\nNome do cliente: [Campo de Texto] | Cpf ou C√≥digo: [Campo de Texto]\nDescreva o erro: [Campo de Texto]\n\nO problema ocorre em qual momento?\n[ ] Login [ ] Recuperar a senha [ ] Biometria [ ] Acesso a faturas.\nSistema Operacional (Android ou iOS): [Campo de Texto]\nMarca (opcional): [Campo de Texto] | Modelo: [Campo de Texto] | Vers√£o do Aplicativo: [Campo de Texto]`
            },
            'HD_CADASTRO_NOVO_PERFIL': {
                name: 'Cria√ß√£o de Novo Perfil de Rede',
                text: `Assunto: Havan Labs - Help Desk - CADASTRO - Cria√ß√£o de Novo Perfil de Rede\n\nCRIAR NOVO PERFIL DE REDE.\n\nNome completo: [Campo de Texto]\nC√≥digo: [Campo de Texto]\nData in√≠cio: [Campo de Texto]\nReadmitido: () Sim () N√£o\nE-mail: () Sim () N√£o\nUsu√°rio espelho para herdar as mesmas permiss√µes: [Campo de Texto]\n(Remoto) E-mail pessoal para envio das informa√ß√µes de login: [Campo de Texto]`
            },
            'HD_OUTROS_TERMO_RESPONSABILIDADE': {
                name: 'Outros - Solicita√ß√£o de Termo de Responsabilidade',
                text: `Assunto: Havan Labs - Help Desk - OUTROS - Termo de Responsabilidade\n\nSOLICITO TERMO DE RESPONSABILIDADE. FL. (Do jeito que o Ilson gosta)\n\nC√≥digo: [Campo de Texto] | Nome: [Campo de Texto] | Setor: [Campo de Texto]\n\nEquipamento: [Campo de Texto]\nFabricante: [Campo de Texto]\nModelo: [Campo de Texto]\nN√∫mero de S√©rie: [Campo de Texto]\nIMEI: [Campo de Texto]`
            },
             'HD_OUTROS_WHATSAPP_BUSINESS_LIDER': {
                name: 'Outros - Cadastro WhatsApp Business (L√≠der)',
                text: `Assunto: Havan Labs - Help Desk - OUTROS - Cadastrar WhatsApp Business (L√≠der)\n\nCADASTRAR WHATSAPP BUSINESS [L√çDER]. FL.\n\nC√≥digo: [Campo de Texto] | Nome: [Campo de Texto] | N√∫mero: [Campo de Texto]\n[ ] L√≠der n√£o possui n√∫mero\n\nSitua√ß√£o:\n[ ] Aumento de quadro;\n[ ] L√≠der novo;\n\nAlgum l√≠der foi recentemente dispensado?\n[ ] N√£o\n[ ] Sim. C√≥digo/Nome: [Campo de Texto]`
            },
            'HD_OUTROS_WHATSAPP_BUSINESS_VENDEDOR': {
                name: 'Outros - Cadastro WhatsApp Business (Vendedor)',
                text: `Assunto: Havan Labs - Help Desk - OUTROS - Cadastrar WhatsApp Business (Vendedor)\n\nCADASTRAR WHATSAPP BUSINESS [VENDEDOR]. FL.\n\nC√≥digo: [Campo de Texto] | Nome: [Campo de Texto] | N√∫mero: [Campo de Texto]\n[ ] Vendedor n√£o possui n√∫mero\n\nSitua√ß√£o:\n[ ] Aumento de quadro;\n[ ] Colaborador promovido;`
            },
            'HD_TEAMS_REUNIAO': {
                name: 'Teams - Aux√≠lio Reuni√£o',
                text: `Assunto: Havan Labs - Help Desk - SOFTWARE - Aux√≠lio Reuni√£o Teams\n\nAux√≠lio reuni√£o via TEAMS terminal [Terminal]. FL.\n\nColaborador(a) entrou em contato solicitando aux√≠lio para participar de uma reuni√£o.\n( ) Microfone inativo\n( ) Webcam sem imagem\n( ) Link de reuni√£o inv√°lido\n( ) Outros: Explique - [Campo de Texto]`
            }
        };

        const categorySelect = document.getElementById('categorySelect');
        const macroSelect = document.getElementById('macroSelect');
        const macroOutput = document.getElementById('macroOutput');
        const macroText = document.getElementById('macroText');
        const feedbackMessage = document.getElementById('feedbackMessage');

        // Estrutura das op√ß√µes do menu suspenso (MANTIDO INALTERADO)
        const macroOptions = {
            'SIGS': [
                { value: 'SIGS_CAMERA_FALHA', text: '1. CFTV - C√¢mera - Falha' },
                { value: 'SIGS_ALARME_SENSOR_PANICO', text: '2. Alarme - Sensor/P√¢nico - Falha' },
                { value: 'SIGS_ALARME_CENTRAL_FALHA', text: '3. Alarme - Central - Falha' },
                { value: 'SIGS_ALARME_CENTRAL_INDIVIDUAL_FALHA', text: '4. Alarme - Central Individual - Falha' },
                { value: 'SIGS_CONTROLE_ACESSO_FALHA', text: '5. Controle de Acesso - Leitor/Biometria' },
                { value: 'SIGS_SECURITY_DESK_ERRO_RP_TELA', text: '6. Security Desk - Erro (RP/TELA)' },
                { value: 'SIGS_SECURITY_DESK_ERRO_TESOURARIA', text: '7. Security Desk - Erro (TESOURARIA)' },
                { value: 'SIGS_SECURITY_DESK_LAYOUT', text: '8. Security Desk - Altera√ß√£o de Layout' },
                { value: 'SIGS_NUUO_ERRO', text: '9. Nuuo - Erro (RP/TESOURARIA)' },
                { value: 'SIGS_ALARME_SENHA', text: '10. Alarme - Senha (Ativa√ß√£o/Desativa√ß√£o)' }
            ],
            'HELP_DESK': [
                { value: 'HD_IMPRESSORA_CAIXA', text: '1. Impressora de Caixa (ECF/NFCe) - Falha' },
                { value: 'HD_IMPRESSORA_SETOR', text: '2. Impressora Setor (Ricoh/Samsung/HP) - Falha' },
                { value: 'HD_IMPRESSORA_ZEBRA', text: '3. Impressora Zebra (Dep√≥sito) - Falha' },
                { value: 'HD_TROCA_ANTECIPADA_TONER', text: '4. Impressora - Troca Antecipada de Toner (Aviso)' },
                { value: 'HD_CAIXA_PINPAD', text: '5. CAIXA - Pinpad (PPC-930) - Falha' },
                { value: 'HD_CAIXA_LEITOR', text: '6. CAIXA - Leitor de C√≥digo de Barras - Falha' },
                { value: 'HD_CAIXA_NFCESAT_INTEGRACAO', text: '7. CAIXA - Erro de Integra√ß√£o NFC-e / SAT' },
                { value: 'HD_CAIXA_SAT_FALHA', text: '8. CAIXA - SAT - Falha' },
                { value: 'HD_CAIXA_POS', text: '9. CAIXA - Maquineta de POS (REDE)'},
                { value: 'HD_NOTAS_FISCAIS', text: '10. Notas Fiscais - Erro de Emiss√£o/Transmiss√£o' },
                { value: 'HD_EMAIL_PROBLEMA', text: '11. E-mail - Problemas (Acesso, Recebimento, Teams, Auth)' },
                { value: 'HD_EMAIL_NOVO_COLABORADOR', text: '12. E-mail - Cria√ß√£o de Usu√°rio/Libera√ß√£o' },
                { value: 'HD_EMAIL_SITEF_WEB', text: '13. E-mail - Cria√ß√£o para SITEF WEB' },
                { value: 'HD_PC_ADM_FALHA', text: '14. Computador ADM/Setor - Falha' },
                { value: 'HD_MONITOR_FALHA', text: '15. Monitor - Falha' },
                { value: 'HD_WEBCAM_FALHA', text: '16. Webcam/C√¢mera de Biometria - Falha' },
                { value: 'HD_REDE_FALHA', text: '17. Rede/Conex√£o - Falha' },
                { value: 'HD_REMOTA_TRAVAMENTO', text: '18. √Årea Remota - Travamento' },
                { value: 'HD_ACESSOS_SISTEMA_GERENCIAL', text: '19. Acessos - Sistema Remoto Gerencial' },
                { value: 'HD_ACESSOS_BLOQUEIO_SITE', text: '20. Acessos - Bloqueio/Libera√ß√£o de Site' },
                { value: 'HD_RF_SOFTWARE_FALHA', text: '21. RF (Software) - Falha' },
                { value: 'HD_RF_HARDWARE_FALHA', text: '22. RF (Hardware) - Carregador/Dano' },
                { value: 'HD_MOBICONTROL_SOFTWARE', text: '23. Mobicontrol (Software) - Falha' },
                { value: 'HD_MOBICONTROL_HARDWARE', text: '24. Mobicontrol (Hardware) - Falha' },
                { value: 'HD_INFINITE_VENDA', text: '25. Infinite - Erro ao Realizar Venda' },
                { value: 'HD_RADIO_FALHA', text: '26. R√°dio/Microfone - Falha' },
                { value: 'HD_TELEFONIA_RAMAL', text: '27. Telefonia/Ramal - Falha' },
                { value: 'HD_RELOGIO_PONTO', text: '28. Rel√≥gio Ponto - Falha' },
                { value: 'HD_TV_INTERNA', text: '29. TV Interna - Falha' },
                { value: 'HD_RELATORIO_FALHA', text: '30. Relat√≥rio - Falha ao Gerar' },
                { value: 'HD_APPHAVAN_ERRO', text: '31. SuperApp Havan - Erro' },
                { value: 'HD_TEAMS_REUNIAO', text: '32. Teams - Aux√≠lio Reuni√£o' },
                { value: 'HD_CADASTRO_NOVO_PERFIL', text: '33. Cadastro - Cria√ß√£o de Novo Perfil de Rede' },
                { value: 'HD_OUTROS_TERMO_RESPONSABILIDADE', text: '34. Outros - Solicita√ß√£o de Termo de Responsabilidade' },
                { value: 'HD_OUTROS_WHATSAPP_BUSINESS_LIDER', text: '35. Outros - Cadastro WhatsApp Business (L√≠der)' },
                { value: 'HD_OUTROS_WHATSAPP_BUSINESS_VENDEDOR', text: '36. Outros - Cadastro WhatsApp Business (Vendedor)' }
            ]
        };

        /**
         * Atualiza as op√ß√µes do segundo dropdown (macroSelect) com base na categoria selecionada.
         */
        function updateMacroOptions() {
            const selectedCategory = categorySelect.value;
            
            // Limpa as op√ß√µes atuais
            macroSelect.innerHTML = '<option value="">-- Selecione um Assunto --</option>';
            macroOutput.style.display = 'none';

            if (selectedCategory && macroOptions[selectedCategory]) {
                // Adiciona as novas op√ß√µes e DESBLOQUEIA a segunda aba
                macroOptions[selectedCategory].forEach(macro => {
                    const option = document.createElement('option');
                    option.value = macro.value;
                    option.textContent = macro.text;
                    macroSelect.appendChild(option);
                });
                macroSelect.disabled = false; // DESBLOQUEIO
            } else {
                 // Mant√©m BLOQUEADA se a categoria principal for vazia
                 macroSelect.innerHTML = '<option value="">-- Selecione uma Categoria Primeiro --</option>';
                 macroSelect.disabled = true; // BLOQUEIO
            }
        }


        /**
         * Exibe a macro selecionada no textarea.
         */
        function displayMacro() {
            const selectedValue = macroSelect.value;
            
            if (selectedValue && allMacros[selectedValue]) {
                macroText.value = allMacros[selectedValue].text;
                macroOutput.style.display = 'block';
                // Garante que a √°rea de texto fique vis√≠vel
                macroOutput.scrollIntoView({ behavior: 'smooth', block: 'start' }); 
            } else {
                macroOutput.style.display = 'none';
            }
            feedbackMessage.style.opacity = '0'; 
        }

        /**
         * Copia o texto da macro para a √°rea de transfer√™ncia.
         */
        function copyMacro() {
            if (!macroText.value) return; 

            macroText.select();
            macroText.setSelectionRange(0, 99999); 
            
            navigator.clipboard.writeText(macroText.value).then(() => {
                feedbackMessage.style.opacity = '1'; 
                
                setTimeout(() => {
                    feedbackMessage.style.opacity = '0';
                }, 3000);
            }).catch(err => {
                console.error('Falha ao copiar:', err);
                alert('Erro ao copiar a macro. Por favor, tente selecionar e copiar manualmente.');
            });
        }
        
        // Chama a fun√ß√£o ao carregar para definir o estado inicial (bloqueado)
        document.addEventListener('DOMContentLoaded', updateMacroOptions); 
    </script>
</body>
</html>